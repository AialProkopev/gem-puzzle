(()=>{"use strict";function e(e,t,n){const a=n[e.y][e.x];n[e.y][e.x]=n[t.y][t.x],n[t.y][t.x]=a}function t(e,t){const n=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);return!(1!==n&&1!==a||e.x!==t.x&&e.y!==t.y)}function n(e,t){for(let n=0;n<t.length;n++)for(let a=0;a<t[n].length;a++)if(t[n][a]===e)return{x:a,y:n};return null}function a(e,t,n){e.style.transform=`translate3D(${100*t}%, ${100*n}%, 0)`}function o(e,t){for(let n=0;n<e.length;n++)for(let o=0;o<e[n].length;o++)a(t[e[n][o]-1],o,n)}let c,s=null;let r=0;function d(){clearInterval(c),function(e){L=e}(r)}const l=function(){return E(4,"defBoard")},i=function(){return E(5,"bigBoard")},u=function(){return E(6,"board6x6")},p=function(){return E(7,"board7x7")},m=function(){return E(8,"board8x8")};let f,L,_=[],v=null,h=null;function x(e){document.querySelector(".header__countMoves").textContent=`moves: ${e}`}const E=function(a,E){_=[],v=null;let g=0;clearInterval(f);const b=new Array(a**2).fill(0).map(((e,t)=>t+1)),C=document.createElement("div");C.classList.add("board-wrapper");const $=document.createElement("div");$.classList.add(E),$.dataset.type=a;for(let e=0;e<b.length;e++){const t=document.createElement("button");t.classList.add(E+"__item"),t.textContent=b[e],t.dataset.matrixId=b[e],$.append(t),_.push(t)}_[_.length-1].style.display="none",v=function(e,t){const n=[];for(let e=0;e<t;e++)n.push([]);let a=0,o=0;for(let c=0;c<e.length;c++)o>=t&&(a++,o=0),n[a][o]=e[c],o++;return n}(_.map((e=>Number(e.dataset.matrixId))),a),o(v,_);const M=a**2;return $.addEventListener("click",(c=>{const s=c.target.closest("button");if(!s)return;const r=n(Number(s.dataset.matrixId),v),f=n(M,v);t(r,f)&&(e(f,r,v),o(v,_),g++,x(g)),function(e,t){let n=0,a=1;for(let o=0;o<e.length;o++)for(let c=0;c<e[o].length;c++){if(e[o][c]===a&&(n+=1),n===t**2)return!0;a+=1}return!1}(v,a)&&setTimeout((()=>{d(),function(e,t,n){const a=document.querySelector(".main");a.innerHTML="",a.append(function(e,t,n){const a=document.createElement("div");a.classList.add("win-popup");const o=document.createElement("div");o.classList.add("win-popup__container");const c=document.createElement("h2");c.classList.add("win-popup__title"),c.textContent="You won!",o.append(c);const s=document.createElement("p");s.classList.add("win-popup__counter"),s.textContent=e+" seconds",o.append(s);const r=document.createElement("p");r.classList.add("win-popup__counter"),r.textContent=t+" moves",o.append(r);const d=document.createElement("button");return d.classList.add("win-popup__restart"),d.textContent="restart",d.addEventListener("click",(()=>{const e=document.querySelector(".main");switch(n){case 3:e.innerHTML="",e.append(y());break;case 4:e.innerHTML="",e.append(l());break;case 5:e.innerHTML="",e.append(i());break;case 6:e.innerHTML="",e.append(u());break;case 7:e.innerHTML="",e.append(p());break;case 8:e.innerHTML="",e.append(m())}})),o.append(d),a.append(o),a}(e,t,n))}(L,g,a),function(e,t,n){const a=`wins${e}x${e}`,o=localStorage.getItem(a),c={time:t,moves:n};let s=[];o?s=[...JSON.parse(o),c]:s.push(c),localStorage.setItem(a,JSON.stringify(s))}(a,L,g)}),100)})),function(e){h=e}(a),C.append($),C.append(function(){const a=document.createElement("button");a.classList.add("glass"),a.textContent="start";const d=50*h;return a.addEventListener("click",(()=>{let l=0;clearInterval(f),0===l&&(f=setInterval((()=>{(function(a,o){const c=n(o**2,a),r=function(e,n,a){const o=[];for(let c=0;c<n.length;c++)for(let s=0;s<n[c].length;s++)t({x:s,y:c},e)&&(a&&a.x===s&&a.y===c||o.push({x:s,y:c}));return o}(c,a,s);e(c,r[Math.floor(Math.random()*r.length)],a),s=c})(v,h),o(v,_),l+=1,l>=d&&(clearInterval(f),w=!w,function(){r=0,clearInterval(c);const e=document.querySelector(".timerCountdown");c=setInterval((()=>{r+=1,e.innerHTML=`time: ${function(e){let t=e%60;t<10&&(t=`0${t}`);let n=(e-t)/60;return n<10&&(n=`0${n}`),`${n}:${t}`}(r)}`}),1e3)}(),x(0))}),30)),a.remove()})),a}()),C},y=function(){return E(3,"smallBoard")};function g(e){const t=document.createElement("div");t.classList.add(`results__div${e}`);const n=document.createElement("h3");n.classList.add("results__subtitle"),n.textContent=`${e}x${e}`,t.append(n);const a=function(e){const t=`wins${e}x${e}`,n=JSON.parse(localStorage.getItem(t));if(!n)return;if(n.length<2)return n;const a=n.sort(((e,t)=>e.time+e.moves-(t.time+t.moves)));return a>10?a.slice[10]:a}(e),o=document.createElement("ul");return o.classList.add("list"),a?(o.append(function(e){const t=e.length,n=new DocumentFragment;for(let a=0;a<t;a++){const t=document.createElement("li");t.classList.add("list__item"),t.textContent=`time: ${e[a].time} sec, moves: ${e[a].moves}`,n.append(t)}return n}(a)),t.append(o)):(o.textContent="---",t.append(o)),t}let w=!1;function b(){const e=document.createElement("header"),t=document.createElement("h1");return e.classList.add("header"),t.classList.add("header__title"),t.textContent="Gem puzzle",e.append(t),e.append(function(){const e=document.createElement("div");return e.classList.add("header__timer"),e.classList.add("timerCountdown"),e.innerHTML="time: 00:00",e}()),e.append(function(e){const t=document.createElement("div");return t.classList.add("header__countMoves"),t.textContent="moves: 0",t}()),e.append(function(){const e=document.createElement("ul");return e.classList.add("header__menu"),e.classList.add("menu"),e.append(function(){const e=new DocumentFragment;for(let t=1;t<=2;t++){const t=document.createElement("li");t.classList.add("menu__item"),e.append(t)}return e}()),e.children[0].append(function(){const e=document.createElement("div");e.classList.add("dropdown");const t=document.createElement("button");t.classList.add("dropdown__button");const n=document.createElement("div");n.classList.add("dropdown__menu"),t.textContent="size";for(let e=1;e<=6;e++){const t=document.createElement("button");t.classList.add("dropdown__item"),t.textContent=`${e+2}x${e+2}`,t.addEventListener("click",(()=>{const n=document.querySelector(".main"),a=[...document.querySelectorAll(".dropdown__item")];1===t.classList.length&&n&&(n.innerHTML=""),t.classList.length<2&&(1===e&&(n.append(y()),C()),2===e&&(n.append(l()),C()),3===e&&(n.append(i()),C()),4===e&&(n.append(u()),C()),5===e&&(n.append(p()),C()),6===e&&(n.append(m()),C())),a.map((e=>(e.classList.remove("dropdown__item_active"),e))),t.classList.add("dropdown__item_active")})),2===e&&t.classList.add("dropdown__item_active"),n.append(t)}return e.append(t),e.append(n),e}()),e.children[1].append(function(){const e=document.createElement("button");return e.classList.add("header__results"),e.textContent="results",e.addEventListener("click",(()=>{!function(){d();const e=document.querySelector(".main");e.innerHTML="",e.append(function(){const e=document.createElement("div");e.classList.add("results");const t=document.createElement("h2");t.classList.add("results__title"),t.textContent="Top 10 results:",e.append(t);const n=document.createElement("div");return n.classList.add("results__wrapper"),n.append(g(3)),n.append(g(4)),n.append(g(5)),n.append(g(6)),n.append(g(7)),n.append(g(7)),e.append(n),e}())}()})),e}()),e}()),e}function C(){x(0),clearInterval(c),document.querySelector(".timerCountdown").innerHTML="time: 00:00"}!function(){const e=document.querySelector("body"),t=document.createElement("div"),n=document.createElement("main");t.classList.add("wrapper"),n.classList.add("main"),t.append(b()),t.append(n),n.append(l()),e.append(t)}()})();